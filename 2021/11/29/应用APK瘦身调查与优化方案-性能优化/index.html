<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>应用APK瘦身调查与优化方案-性能优化 | Learn OS concepts by coding them!</title><meta name="keywords" content="性能优化,apk瘦身,Android"><meta name="author" content="Jack Ou"><meta name="copyright" content="Jack Ou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="本篇文章记录apk瘦身调查方法和优化建议。">
<meta property="og:type" content="article">
<meta property="og:title" content="应用APK瘦身调查与优化方案-性能优化">
<meta property="og:url" content="https://oujie123.github.io/2021/11/29/%E5%BA%94%E7%94%A8APK%E7%98%A6%E8%BA%AB%E8%B0%83%E6%9F%A5%E4%B8%8E%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/index.html">
<meta property="og:site_name" content="Learn OS concepts by coding them!">
<meta property="og:description" content="本篇文章记录apk瘦身调查方法和优化建议。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/13838098-cdda3865282e1bb4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="article:published_time" content="2021-11-29T07:45:03.000Z">
<meta property="article:modified_time" content="2021-11-29T13:23:59.422Z">
<meta property="article:author" content="Jack Ou">
<meta property="article:tag" content="性能优化">
<meta property="article:tag" content="apk瘦身">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/13838098-cdda3865282e1bb4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><link rel="shortcut icon" href="https://upload-images.jianshu.io/upload_images/13838098-8a5cd66eafd7c761.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"><link rel="canonical" href="https://oujie123.github.io/2021/11/29/%E5%BA%94%E7%94%A8APK%E7%98%A6%E8%BA%AB%E8%B0%83%E6%9F%A5%E4%B8%8E%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Jack Ou","link":"链接: ","source":"来源: Learn OS concepts by coding them!","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-29 21:23:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://upload-images.jianshu.io/upload_images/13838098-a7dfe0e9d3ed649c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">144</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">103</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分栏</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://upload-images.jianshu.io/upload_images/13838098-cdda3865282e1bb4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Learn OS concepts by coding them!</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分栏</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">应用APK瘦身调查与优化方案-性能优化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-29T07:45:03.000Z" title="发表于 2021-11-29 15:45:03">2021-11-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-29T13:23:59.422Z" title="更新于 2021-11-29 21:23:59">2021-11-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android/">Android</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="1-背景"><a href="#1-背景" class="headerlink" title="1.背景"></a>1.背景</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jieou@gxatek-fw-no:<span class="regexp">/work/</span>jieou/gxa_gos2$ du -h output/</span><br><span class="line">13G	output/</span><br></pre></td></tr></table></figure>
<p>从上面可以看到，当前车机系统一个整包大小为13G多，意思是用户如果需要OTA升级整包的话，需要下载13G多的包，一方面车机后台静默下载系统包流量和速度都是不小的考验；另一方面，一次完整系统升级需要半个多小时，如果用户有感的话，那肯定是煎熬，再则APK 的大小会影响应用加载速度、使用的内存量以及消耗的电量。从系统整体来看，主要是APK大小和各个资源文件最占磁盘。本文主要从APK瘦身角度，分析哪些工具可以检测APK可优化点，APK瘦身的方向有哪些。</p>
<h3 id="2-APK结构"><a href="#2-APK结构" class="headerlink" title="2.APK结构"></a>2.APK结构</h3><p>在讨论如何缩减应用的大小之前，有必要了解下应用 APK 的结构。APK 文件由一个 Zip 压缩文件组成，其中包含构成应用的所有文件。这些文件包括 Java 类文件、资源文件和包含已编译资源的文件。</p>
<p>APK 包含以下目录：</p>
<ul>
<li><p><code>META-INF/ </code>：包含 <code>CERT.SF </code>和 <code>CERT.RSA </code>签名文件，以及 <code>MANIFEST.MF </code>清单文件。</p>
</li>
<li><p><code>assets/ </code>：包含应用的资源；应用可以使用<code> AssetManager</code> 对象检索这些资源。</p>
</li>
<li><p><code>res/ </code>：包含未编译到<code> resources.arsc</code> 中的资源（图片、音视频等）。</p>
</li>
<li><p><code>lib/</code> ：包含特定于处理器软件层的已编译代码。此目录包含每种平台类型的子目录，如 <code>armeabi </code>、 </p>
<p><code>armeabi-v7a</code> 、 <code>arm64-v8a</code> 、<code>x86</code>、 <code>x86_64</code> 和 <code>mips</code> 。</p>
</li>
</ul>
<p>APK 还包含以下文件。在这些文件中，只有 <code>AndroidManifest.xml </code>是必需的.</p>
<ul>
<li><p><code>resources.arsc </code>：包含已编译的资源。此文件包含 <code>res/values/ </code>文件夹的所有配置中的 XML 内容。打包工具会提取此 XML 内容，将其编译为二进制文件形式，并压缩内容。此内容包括语言字符串和样式，以及未直接包含在<code>resources.arsc</code>文件中的内容（例如布局文件和图片）的路径。</p>
</li>
<li><p><code>classes.dex </code>：包含以 Dalvik/ART 虚拟机可理解的 DEX 文件格式编译的类。</p>
</li>
<li><p><code>AndroidManifest.xml </code>：包含核心 Android 清单文件。此文件列出了应用的名称、版本、访问权限和引用的库文件。该文件使用 Android 的二进制 XML 格式。</p>
</li>
</ul>
<h3 id="3-Android-Size-Analyzer工具介绍"><a href="#3-Android-Size-Analyzer工具介绍" class="headerlink" title="3. Android Size Analyzer工具介绍"></a>3. Android Size Analyzer工具介绍</h3><p>Android Size Analyzer 工具可让您轻松地发现和实施多种缩减应用大小的策略。它可以作为 Android Studio 插件或独立的 JAR 使用。</p>
<h4 id="3-1-在-Android-Studio-中使用-Android-Size-Analyzer"><a href="#3-1-在-Android-Studio-中使用-Android-Size-Analyzer" class="headerlink" title="3.1 在 Android Studio 中使用 Android Size Analyzer"></a>3.1 在 Android Studio 中使用 Android Size Analyzer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">！！！！现在我看了好多Android Studio版本都在插件中找不到这个插件了，如果能下载到可以使用，如果下载不到，可以按照<span class="number">3.2</span>使用命令行来检查。</span><br></pre></td></tr></table></figure>
<p>您可以使用 Android Studio 中的插件市场下载 Android Size Analyzer 插件，如图 1 所示。要打开插件市场并安装该插件，请按以下步骤操作：</p>
<ol>
<li>依次选择 <strong>File &gt; Settings</strong>（或在 Mac 上，依次选择 <strong>Android Studio &gt; Preferences</strong>）。</li>
<li>选择左侧面板中的 <strong>Plugins</strong> 部分。</li>
<li>点击 <strong>Marketplace</strong> 标签。</li>
<li>搜索“Android Size Analyzer”插件。</li>
<li>点击分析器插件的 <strong>Install</strong> 按钮。</li>
</ol>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-992871d0f31daee9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="AndroidSizeAnalyzer.png"></p>
<p><strong>图 1.</strong> “Marketplace”标签中的“Android Size Analyzer”插件。</p>
<p>安装插件后，从菜单栏中依次选择 <strong>Analyze &gt; Analyze App Size</strong>，对当前项目运行应用大小分析。分析了项目后，系统会显示一个工具窗口，其中包含有关如何缩减应用大小的建议，如图 2 所示。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-607313892bc9658f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="plugin-recommendations.png"></p>
<p><strong>图 2.</strong> 包含建议的 Android Size Analyzer 插件工具窗口。</p>
<h4 id="3-2-通过命令行使用分析器"><a href="#3-2-通过命令行使用分析器" class="headerlink" title="3.2 通过命令行使用分析器"></a>3.2 通过命令行使用分析器</h4><p>您可以<a target="_blank" rel="noopener" href="https://github.com/android/size-analyzer/releases/tag/v0.3.1">从 GitHub</a> 以 TAR 或 ZIP 文件形式下载最新版本的 Android Size Analyzer。解压缩文件后，使用以下某个命令对 Android 项目或 Android App Bundle 运行 size-analyzer 脚本（在 Linux 或 MacOS 上）或 size-analyzer.bat 脚本（在 Windows 上）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;size-analyzer check-bundle &lt;path-to-aab&gt;</span><br><span class="line">.&#x2F;size-analyzer check-project &lt;path-to-project-directory&gt;</span><br></pre></td></tr></table></figure>


<h5 id="3-2-1-使用analyzer-jar"><a href="#3-2-1-使用analyzer-jar" class="headerlink" title="3.2.1 使用analyzer.jar"></a>3.2.1 使用analyzer.jar</h5><p>下载<a target="_blank" rel="noopener" href="https://github.com/android/size-analyzer">size-analyzer</a>工程，使用Android Studio打开工程，然后使用gradlew来编译<code>analyzer.jar</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew :analyzer:executableJar</span><br></pre></td></tr></table></figure>
<p>编译完成之后，会在<code>analyzer\build\libs\</code>下生成analyzer.jar。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java -jar analyzer/build/libs/analyzer.jar check-bundle &lt;path-to-aab&gt;</span><br><span class="line">java -jar analyzer/build/libs/analyzer.jar check-project &lt;path-to-project-directory&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入 -d 参数可以直接输出优化建议</span></span><br><span class="line">java -jar analyzer.jar check-project -d xlauncher/</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">优化建议如下</span><br><span class="line">Converting images to webp 17.1 MiB</span><br><span class="line">Convert submodule_map\common\src\main\res\drawable-mdpi\xunzhang_gq1.png to webp with lossless encoding (saves 2.8 MiB)</span><br><span class="line">Convert submodule_map\base\src\main\assets\xunzhang\fkscs.png to webp with lossless encoding (saves 2.7 MiB)</span><br><span class="line">Convert submodule_map\base\src\main\assets\xunzhang\mlbz.png to webp with lossless encoding (saves 2.6 MiB)</span><br><span class="line">Convert submodule_map\base\src\main\assets\xunzhang\qmslsj.png to webp with lossless encoding (saves 2.3 MiB)</span><br><span class="line">Convert submodule_map\mainmap\src\main\res\drawable-mdpi\mainmap_food_theme_bg.png to webp with lossless encoding (saves 341.0 kiB)</span><br><span class="line">Convert submodule_map\exploremap\src\main\res\drawable\icon_explore_map_back.png to webp with lossless encoding (saves 290.4 kiB)</span><br><span class="line">Convert app\src\main\res\drawable\ic_car.png to webp with lossless encoding (saves 249.3 kiB)</span><br><span class="line">Convert submodule_map\exploremap\src\main\res\drawable\icon_explore_map_back2.png to webp with lossless encoding (saves 183.2 kiB)</span><br><span class="line">Convert submodule_map\setting\src\main\res\drawable-mdpi\setting_map_theme_set_bg.png to webp with lossless encoding (saves 154.5 kiB)</span><br><span class="line">Convert submodule_map\setting\src\main\res\drawable-mdpi\setting_account_bg.png to webp with lossless encoding (saves 152.7 kiB)</span><br><span class="line">Convert app\src\main\res\drawable\eric.png to webp with lossless encoding (saves 135.4 kiB)</span><br><span class="line">.......</span><br><span class="line"><span class="meta">#</span><span class="bash"> 检测到没有开启混淆和R8优化，后面拿launcher专门分析的时候会讲解到</span></span><br><span class="line">It seems that you are not using Proguard/R8, consider enabling it in your application. (saves )</span><br></pre></td></tr></table></figure>
<p>可以看到如果将列出的图片从png转化成webp格式，可以节约<strong>17.1M</strong>空间</p>
<h3 id="4-Gradle启动资源缩减"><a href="#4-Gradle启动资源缩减" class="headerlink" title="4 Gradle启动资源缩减"></a>4 Gradle启动资源缩减</h3><p>如果在应用的 build.gradle 文件中启用了资源缩减： <code>shrinkResources </code>，则 Gradle 在打包APK时可以自动忽略未使用资源。 资源缩减只有在与代码缩减： <code>minifyEnabled </code>配合使用时才能发挥作用。在代码缩减器移除所有不使用的代码后，资源缩减器便可确定应用仍要使用的资源 。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">android &#123; </span><br><span class="line">	<span class="comment">// Other settings </span></span><br><span class="line">	buildTypes &#123; </span><br><span class="line">		release &#123; </span><br><span class="line">			minifyEnabled <span class="literal">true</span> </span><br><span class="line">			shrinkResources <span class="literal">true</span> </span><br><span class="line">			proguardFiles getDefaultProguardFile(<span class="string">&#x27;proguard-android.txt&#x27;</span>), <span class="string">&#x27;proguard-rules.pro&#x27;</span> </span><br><span class="line">		&#125; </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="5-使用Lint分析器（物理删除）"><a href="#5-使用Lint分析器（物理删除）" class="headerlink" title="5 使用Lint分析器（物理删除）"></a>5 使用Lint分析器（物理删除）</h3><p><code>lint</code> 工具是 Android Studio 中附带的静态代码分析器，可检测到<code>res/</code>文件夹中未被代码引用的资源。从菜单栏中依次选择 <strong>Analyze &gt; Run Inspection By Name</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-9043d03929bbf876.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="lint检测.png"></p>
<p>lint分析完成之后，结果如下：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-94e0d32e5912fd47.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="未使用资源.png"></p>
<p>可以看出有大量png资源没有使用到。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-c474dfaf6c3ed1da.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="资源处理说明.png"></p>
<p>lint 工具不会扫描 <code>assets/</code> 文件夹、通过反射引用的资源或已链接至应用的库文件。此外，它也不会移除资源，只会提醒您它们的存在。 <strong>与资源缩减不同，这里点击删除，那就是把文件删了。</strong></p>
<p>反射引用资源：getResources().getIdentififier(“layout_main”,”layout”,getPackageName());</p>
<p>此处不建议点击直接<code>删除所有未使用资源</code>，FO还是自己确认一下是否确实没有使用到。</p>
<h4 id="5-1-一键删除无用资源"><a href="#5-1-一键删除无用资源" class="headerlink" title="5.1 一键删除无用资源"></a>5.1 一键删除无用资源</h4><p>Android Studio给我们提供了一键移除所有无用的资源。从菜单栏中依次选择 <strong>Refactor &gt; Remove Unused Resources</strong>，但是这种方式不建议使用，因为如果某资源仅存在动态获取资源id 的方式，那么这个资源会被认为没有使用过，从而会直接被删除。</p>
<h4 id="5-2-自定义要保留的资源"><a href="#5-2-自定义要保留的资源" class="headerlink" title="5.2 自定义要保留的资源"></a>5.2 自定义要保留的资源</h4><p>如果有想要特别声明需要保留或舍弃的特定资源，在项目中创建一个包含 <code>&lt;resources&gt; </code>标记的 XML 文件，并在<code>tools:keep</code>属性中指定每个要保留的资源，在<code>tools:discard</code>属性中指定每个要舍弃的资源。这两个属性都接受以逗号分隔的资源名称列表。还可以将星号字符用作通配符。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">resources</span> <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span> 		</span></span><br><span class="line"><span class="tag">	<span class="attr">tools:keep</span>=<span class="string">&quot;@layout/l_used*_c,@layout/l_used_a,@layout/l_used_b*&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">tools:discard</span>=<span class="string">&quot;@layout/unused2&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>将该文件保存在项目资源中，例如，保存在 <code>res/raw/keep.xml </code>中。构建系统不会将此文件打包到 APK 中。</p>
<h4 id="5-3-移除未使用的备用资源"><a href="#5-3-移除未使用的备用资源" class="headerlink" title="5.3 移除未使用的备用资源"></a>5.3 移除未使用的备用资源</h4><p>Gradle 资源缩减器只会移除未由应用代码引用的资源，这意味着，它不会移除用于不同设备配置的备用资源。可以使用 Android Gradle 插件的 <code>resConfigs </code>属性移除应用不需要的备用资源文件。</p>
<p>例如，如果使用的是包含语言资源的库（如 AppCompat ），那么 APK 中将包含这些库中所有已翻译语言的字符串。如果只想保留应用正式支持的语言，则可以使用 <code>resConfig</code> 属性指定这些语言。系统会移除未指定语言的所有资源。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-2378579e9f0a38ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="字体资源.png"></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">android &#123; </span><br><span class="line">	defaultConfig &#123; </span><br><span class="line">		... </span><br><span class="line">		resConfigs <span class="string">&quot;zh-rCN&quot;</span> </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置resConfifigs 只打包默认与简体中文资源。</p>
<h3 id="6-动态库打包配置"><a href="#6-动态库打包配置" class="headerlink" title="6 动态库打包配置"></a>6 动态库打包配置</h3><p>so文件是由ndk编译出来的动态库，是 c/c++ 写的，所以不是跨平台的。ABI 是应用程序二进制接口简称（Application Binary Interface），定义了二进制文件（尤其是.so文件）如何运行在相应的系统平台上，从使用的指令集，内存对齐到可用的系统函数库。在Android 系统中，每一个CPU架构对应一个ABI，目前支持的有：<code>armeabi-v7a，arm64- v8a，x86，x86_64</code>。目前市面上手机设备基本上都是arm架构， armeabi-v7a 几乎能兼容所有设备。因此可以配置：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">android&#123; </span><br><span class="line">	defaultConfig&#123; </span><br><span class="line">		ndk&#123;</span><br><span class="line">			abiFilters <span class="string">&quot;armeabi-v7a&quot;</span> </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是！！！！但是！！！！但是！！！！针对我们当前车机，是<code>arm64-v8a</code>的，留有<code>arm64-v8a</code>就行，不要把支持<code>arm64-v8a</code>和<code>armeabi-v7a</code>的所有so库都打入到apk包中。</p>
<p>对于第三方服务，如百度地图、Bugly等会提供全平台的cpu架构。进行了上面的配置之后，表示只会把<code>armeabi-v7a</code>打包进入Apk。从而减少APK大小。</p>
<p>对于arm64架构的设备，如果使用armeabi-v7a也能够兼容，但是不如使用arm64的so性能。因此现在部分应用市场会根据设备提供不同架构的Apk安装。此时我们需要打包出针对arm64的apk与armv7a的apk，可以使用<code>productFlavor</code>。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">flavorDimensions <span class="string">&quot;default&quot;</span> </span><br><span class="line">productFlavors&#123; </span><br><span class="line">	arm32 &#123;</span><br><span class="line">		dimension <span class="string">&quot;default&quot;</span></span><br><span class="line">		ndk &#123;</span><br><span class="line">			abiFilters <span class="string">&quot;armeabi-v7a&quot;</span> </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	arm64 &#123;</span><br><span class="line">		dimension <span class="string">&quot;default&quot;</span> </span><br><span class="line">		ndk &#123;</span><br><span class="line">			abiFilters <span class="string">&quot;arm64-v8a&quot;</span> </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可以使用，但不建议：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">splits &#123; </span><br><span class="line">	abi &#123;</span><br><span class="line">		enable <span class="literal">true</span> </span><br><span class="line">		reset() </span><br><span class="line">		include <span class="string">&#x27;arm64-v8a&#x27;</span>,<span class="string">&#x27;armeabi-v7a&#x27;</span> </span><br><span class="line">		<span class="comment">// exclude &#x27;armeabi&#x27; </span></span><br><span class="line">		universalApk <span class="literal">true</span> <span class="comment">//是否打包一个包含所有so的apk </span></span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="7-使用矢量图"><a href="#7-使用矢量图" class="headerlink" title="7 使用矢量图"></a>7 使用矢量图</h3><p>Apk中图片应该算是占用空间最多的资源。我们可以使用webp减少png、jpg图片占用空间的大小。对于小图标也可以使用矢量图。</p>
<p>矢量图可以创建与分辨率无关的图标和其他可伸缩媒体。使用这些图形可以极大地减少 APK 占用的空间。 矢量图片在 Android 中以 <code>VectorDrawable </code>对象的形式表示。借助 <code>VectorDrawable</code> 对象，100 字节的文件可以生成与屏幕大小相同的清晰图片。</p>
<p>不过，系统渲染每个 VectorDrawable 对象需要花费大量时间，而较大的图片则需要更长的时间才能显示在屏幕上。因此，<strong>建议仅在显示小图片时使用这些矢量图</strong>。</p>
<p><strong>新工程默认Icon就是矢量图。</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-0e7b997958165cfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建矢量图.png"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-b585cc62688a90e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建矢量图对话框.png"></p>
<h3 id="8-压缩PNG文件"><a href="#8-压缩PNG文件" class="headerlink" title="8 压缩PNG文件"></a>8 压缩PNG文件</h3><p><code>aapt</code> 工具可以在编译过程中通过无损压缩来优化放置在 <code>res/drawable/</code> 中的图片资源。例如，<code>aapt</code> 工具可以通过调色板将不需要超过 256 种颜色的真彩色 PNG 转换为 8 位 PNG。这样做会生成质量相同但内存占用量更小的图片。</p>
<p>请记住，<code>aapt</code> 具有以下限制：</p>
<ul>
<li><code>aapt</code> 工具不会缩减 <code>asset/</code> 文件夹中包含的 PNG 文件。</li>
<li>图片文件需要使用 256 种或更少的颜色才可供 <code>aapt</code> 工具进行优化。</li>
<li><code>aapt</code> 工具可能会扩充已压缩的 PNG 文件。为防止出现这种情况，您可以在 Gradle 中使用 <code>cruncherEnabled</code> 标记为 PNG 文件停用此过程：</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aaptOptions &#123;</span><br><span class="line">    cruncherEnabled = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="8-1-压缩-PNG-和-JPEG-文件工具"><a href="#8-1-压缩-PNG-和-JPEG-文件工具" class="headerlink" title="8.1 压缩 PNG 和 JPEG 文件工具"></a>8.1 压缩 PNG 和 JPEG 文件工具</h4><p>您可以使用 <a target="_blank" rel="noopener" href="http://pmt.sourceforge.net/pngcrush/">pngcrush</a>、<a target="_blank" rel="noopener" href="https://pngquant.org/">pngquant</a> 或 <a target="_blank" rel="noopener" href="https://github.com/google/zopfli">zopflipng</a> 等工具缩减 PNG 文件的大小，同时不损失画质。所有这些工具都可以缩减 PNG 文件的大小，同时保持肉眼感知的画质不变。</p>
<p><code>pngcrush</code> 工具尤为有效：该工具会迭代 PNG 过滤器和 zlib (Deflate) 参数，使用过滤器和参数的每个组合来压缩图片。然后，它会选择可产生最小压缩输出的配置。</p>
<p>要压缩 JPEG 文件，您可以使用 <a target="_blank" rel="noopener" href="http://www.elektronik.htw-aalen.de/packjpg/">packJPG</a> 和 <a target="_blank" rel="noopener" href="https://github.com/google/guetzli">guetzli</a> 等工具。</p>
<h3 id="9-重复使用资源"><a href="#9-重复使用资源" class="headerlink" title="9 重复使用资源"></a>9 重复使用资源</h3><p>现在我们有一个矢量图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;vector xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot; </span><br><span class="line">	android:width&#x3D;&quot;24dp&quot; </span><br><span class="line">	android:height&#x3D;&quot;24dp&quot; </span><br><span class="line">	android:viewportWidth&#x3D;&quot;24&quot; </span><br><span class="line">	android:viewportHeight&#x3D;&quot;24&quot; </span><br><span class="line">	android:tint&#x3D;&quot;?attr&#x2F;colorControlNormal&quot;&gt; </span><br><span class="line">	&lt;path</span><br><span class="line">	android:fillColor&#x3D;&quot;@android:color&#x2F;black&quot; </span><br><span class="line">	android:pathData&#x3D;&quot;M10,20v-6h4v6h5v-8h3L12,3 2,12h3v8z&quot;&#x2F;&gt; </span><br><span class="line">&lt;&#x2F;vector&gt;</span><br></pre></td></tr></table></figure>
<p>显示效果如下：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-d47031bbe22a273d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="矢量图黑色显示效果.png"></p>
<p>如果我们需要让矢量图显示红色怎么办？这种情况，我们不需要再去创建一个新的矢量图。可以直接给 ImageView设置  <code>android:tint</code> 属性 来完成颜色的修改。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_width</span>=<span class="string">&quot;50dp&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_height</span>=<span class="string">&quot;50dp&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:tint</span>=<span class="string">&quot;@color/colorAccent&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:src</span>=<span class="string">&quot;@drawable/tabbar_home_vector&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13838098-985b0dae7952f225.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="矢量图粉红色显示效果.png"></p>
<h3 id="10-选择器"><a href="#10-选择器" class="headerlink" title="10 选择器"></a>10 选择器</h3><p>如果需要让矢量图实现触摸变色。只需要创建selector，设置给tint即可。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- tabbar_home_tint_selector --&gt;</span> </span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">selector</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> <span class="attr">android:state_pressed</span>=<span class="string">&quot;true&quot;</span> /&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">item</span> <span class="attr">android:color</span>=<span class="string">&quot;@color/colorAccent&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">selector</span>&gt;</span></span><br></pre></td></tr></table></figure>


<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:clickable</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_width</span>=<span class="string">&quot;50dp&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_height</span>=<span class="string">&quot;50dp&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:src</span>=<span class="string">&quot;@drawable/tabbar_home_vector&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">android:tint</span>=<span class="string">&quot;@color/tabbar_home_tint_selector&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.iconfont.cn/help/detail?spm=a313x.7781069.1998910419.d8d11a391&helptype=code">阿里矢量图库</a></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li><p>使用精简版本的依赖：如protobuf-lite版本；对于分模块的库按需引入：如netty分模块引入；</p>
</li>
<li><p>主动移除无用代码（开启R8/Progurad自动移除）</p>
</li>
<li><p>避免使用枚举，使用 @IntDef 代替。</p>
</li>
<li><p>开启资源混淆：<a target="_blank" rel="noopener" href="https://github.com/shwenzhang/AndResGuard">https://github.com/shwenzhang/AndResGuard</a></p>
</li>
<li><p>支付宝删除Dex debugItem <a target="_blank" rel="noopener" href="https://juejin.im/post/6844903712201277448">https://juejin.im/post/6844903712201277448</a></p>
</li>
<li><p>对于发布Google paly的应用选择使用：AAB <a target="_blank" rel="noopener" href="https://developer.android.google.cn/guide/app-bundle">https://developer.android.google.cn/guide/app-bundle</a></p>
</li>
<li><p>避免解压缩原生库：在构建应用的发布版本时，您可以通过在应用清单的<code>&lt;application&gt;</code>元素中设置 <code>android:extractNativeLibs=&quot;false&quot;</code>，将未压缩的 <code>.so</code> 文件打包在 APK 中。停用此标记可防止 <code>PackageManager</code> 在安装过程中将 <code>.so</code> 文件从 APK 复制到文件系统，并具有减小应用更新的额外好处。使用 Android Gradle 插件 3.6.0 或更高版本构建应用时，插件会默认将此属性设为 <code>&quot;false&quot;</code>。</p>
</li>
</ul>
<h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><p><a target="_blank" rel="noopener" href="https://developer.android.google.cn/topic/performance/reduce-apk-size">1.缩减应用大小  | Android 开发者  | Android Developers (google.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/android/size-analyzer">2.开源工具android/size-analyzer: The size-analyzer is a tool to help developers find tips on how to reduce the size of their Android application. (github.com)</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://www.jianshu.com/u/10058d760200">Jack Ou</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://www.jianshu.com/u/10058d760200">https://www.jianshu.com/u/10058d760200</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">此文章版权归Jack Ou所有，如有转载，请註明来自原作者</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">性能优化</a><a class="post-meta__tags" href="/tags/apk%E7%98%A6%E8%BA%AB/">apk瘦身</a></div><div class="post_share"><div class="social-share" data-image="https://upload-images.jianshu.io/upload_images/13838098-cdda3865282e1bb4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://upload-images.jianshu.io/upload_images/13838098-2431fc1f0eb1b702.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" target="_blank"><img class="post-qr-code-img" src="https://upload-images.jianshu.io/upload_images/13838098-2431fc1f0eb1b702.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://upload-images.jianshu.io/upload_images/13838098-ea2cb9b10bc2f743.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" target="_blank"><img class="post-qr-code-img" src="https://upload-images.jianshu.io/upload_images/13838098-ea2cb9b10bc2f743.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/12/01/Selinux%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E%E4%B9%A6/"><img class="prev-cover" src="https://upload-images.jianshu.io/upload_images/13838098-ceb8ed2a66722632.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Selinux配置说明书</div></div></a></div><div class="next-post pull-right"><a href="/2021/11/29/%E8%A7%A3%E5%86%B3Monkey%E8%BF%87%E7%A8%8B%E4%B8%ADCarService%E5%81%B6%E5%8F%91%E5%B4%A9%E6%BA%83%E9%97%AE%E9%A2%98/"><img class="next-cover" src="https://upload-images.jianshu.io/upload_images/13838098-087c0f1ecf7256b5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">解决Monkey过程中CarService偶发崩溃问题</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/08/14/Dumpsys命令详细说明/" title="Dumpsys命令详细说明"><img class="cover" src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-14</div><div class="title">Dumpsys命令详细说明</div></div></a></div><div><a href="/2021/08/12/解析dumpsys-cpuinfo/" title="解析dumpsys cpuinfo"><img class="cover" src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-12</div><div class="title">解析dumpsys cpuinfo</div></div></a></div><div><a href="/2021/08/14/解析dumpsys-gfxinfo/" title="解析dumpsys gfxinfo"><img class="cover" src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-14</div><div class="title">解析dumpsys gfxinfo</div></div></a></div><div><a href="/2021/08/14/解析dumpsys-meminfo/" title="解析dumpsys meminfo"><img class="cover" src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-14</div><div class="title">解析dumpsys meminfo</div></div></a></div><div><a href="/2021/08/15/性能优化-分析应用性能/" title="性能优化--分析应用性能"><img class="cover" src="https://upload-images.jianshu.io/upload_images/13838098-cdda3865282e1bb4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-15</div><div class="title">性能优化--分析应用性能</div></div></a></div><div><a href="/2021/08/16/解析cat-proc-meminfo/" title="解析cat /proc/meminfo"><img class="cover" src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-16</div><div class="title">解析cat /proc/meminfo</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://upload-images.jianshu.io/upload_images/13838098-a7dfe0e9d3ed649c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Jack Ou</div><div class="author-info__description">努力成为靠谱之人：凡事有交代，件件有着落，事事有回音</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">144</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">103</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://www.jianshu.com/u/10058d760200"><i class="fad fa-sheep"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/oujie123" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://www.jianshu.com/u/10058d760200" target="_blank" title="简书"><i class="fas fa-book-open"></i></a><a class="social-icon" href="https://blog.csdn.net/u010248147" target="_blank" title="CSDN"><i class="fab fa-microblog"></i></a><a class="social-icon" href="mailto:jackou4work@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎收看我的博客，很高兴与您一同成长！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">1.背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-APK%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">2.APK结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Android-Size-Analyzer%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">3. Android Size Analyzer工具介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%9C%A8-Android-Studio-%E4%B8%AD%E4%BD%BF%E7%94%A8-Android-Size-Analyzer"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 在 Android Studio 中使用 Android Size Analyzer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BD%BF%E7%94%A8%E5%88%86%E6%9E%90%E5%99%A8"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 通过命令行使用分析器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-%E4%BD%BF%E7%94%A8analyzer-jar"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 使用analyzer.jar</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Gradle%E5%90%AF%E5%8A%A8%E8%B5%84%E6%BA%90%E7%BC%A9%E5%87%8F"><span class="toc-number">4.</span> <span class="toc-text">4 Gradle启动资源缩减</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BD%BF%E7%94%A8Lint%E5%88%86%E6%9E%90%E5%99%A8%EF%BC%88%E7%89%A9%E7%90%86%E5%88%A0%E9%99%A4%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">5 使用Lint分析器（物理删除）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-%E4%B8%80%E9%94%AE%E5%88%A0%E9%99%A4%E6%97%A0%E7%94%A8%E8%B5%84%E6%BA%90"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 一键删除无用资源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A6%81%E4%BF%9D%E7%95%99%E7%9A%84%E8%B5%84%E6%BA%90"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 自定义要保留的资源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-%E7%A7%BB%E9%99%A4%E6%9C%AA%E4%BD%BF%E7%94%A8%E7%9A%84%E5%A4%87%E7%94%A8%E8%B5%84%E6%BA%90"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 移除未使用的备用资源</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%8A%A8%E6%80%81%E5%BA%93%E6%89%93%E5%8C%85%E9%85%8D%E7%BD%AE"><span class="toc-number">6.</span> <span class="toc-text">6 动态库打包配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E4%BD%BF%E7%94%A8%E7%9F%A2%E9%87%8F%E5%9B%BE"><span class="toc-number">7.</span> <span class="toc-text">7 使用矢量图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%8E%8B%E7%BC%A9PNG%E6%96%87%E4%BB%B6"><span class="toc-number">8.</span> <span class="toc-text">8 压缩PNG文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-%E5%8E%8B%E7%BC%A9-PNG-%E5%92%8C-JPEG-%E6%96%87%E4%BB%B6%E5%B7%A5%E5%85%B7"><span class="toc-number">8.1.</span> <span class="toc-text">8.1 压缩 PNG 和 JPEG 文件工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8%E8%B5%84%E6%BA%90"><span class="toc-number">9.</span> <span class="toc-text">9 重复使用资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">10.</span> <span class="toc-text">10 选择器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">11.</span> <span class="toc-text">其他</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-number">12.</span> <span class="toc-text">参考文档</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/12/08/20211208%E8%BD%A6%E6%9C%BA%E6%95%B4%E4%BD%93%E6%80%A7%E8%83%BD%E6%8A%A5%E5%91%8A/" title="20211208车机整体性能报告"><img src="https://upload-images.jianshu.io/upload_images/13838098-68e128c62e879dbb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="20211208车机整体性能报告"/></a><div class="content"><a class="title" href="/2021/12/08/20211208%E8%BD%A6%E6%9C%BA%E6%95%B4%E4%BD%93%E6%80%A7%E8%83%BD%E6%8A%A5%E5%91%8A/" title="20211208车机整体性能报告">20211208车机整体性能报告</a><time datetime="2021-12-08T03:10:35.000Z" title="发表于 2021-12-08 11:10:35">2021-12-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/07/Linux%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%88%86%E6%9E%903-%E8%B0%83%E5%BA%A6%E5%87%BD%E6%95%B0/" title="Linux进程调度分析3-调度函数"><img src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux进程调度分析3-调度函数"/></a><div class="content"><a class="title" href="/2021/12/07/Linux%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%88%86%E6%9E%903-%E8%B0%83%E5%BA%A6%E5%87%BD%E6%95%B0/" title="Linux进程调度分析3-调度函数">Linux进程调度分析3-调度函数</a><time datetime="2021-12-07T15:58:48.000Z" title="发表于 2021-12-07 23:58:48">2021-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/07/Linux%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%88%86%E6%9E%902-%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95/" title="Linux进程调度分析1-调度算法"><img src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux进程调度分析1-调度算法"/></a><div class="content"><a class="title" href="/2021/12/07/Linux%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%88%86%E6%9E%902-%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95/" title="Linux进程调度分析1-调度算法">Linux进程调度分析1-调度算法</a><time datetime="2021-12-07T15:24:48.000Z" title="发表于 2021-12-07 23:24:48">2021-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/07/Linux%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%88%86%E6%9E%901-%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5/" title="Linux进程调度分析1-调度策略"><img src="https://upload-images.jianshu.io/upload_images/13838098-5d55fd74e9c304b9.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux进程调度分析1-调度策略"/></a><div class="content"><a class="title" href="/2021/12/07/Linux%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E5%88%86%E6%9E%901-%E8%B0%83%E5%BA%A6%E7%AD%96%E7%95%A5/" title="Linux进程调度分析1-调度策略">Linux进程调度分析1-调度策略</a><time datetime="2021-12-07T14:40:04.000Z" title="发表于 2021-12-07 22:40:04">2021-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/01/Selinux%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E%E4%B9%A6/" title="Selinux配置说明书"><img src="https://upload-images.jianshu.io/upload_images/13838098-ceb8ed2a66722632.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Selinux配置说明书"/></a><div class="content"><a class="title" href="/2021/12/01/Selinux%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E%E4%B9%A6/" title="Selinux配置说明书">Selinux配置说明书</a><time datetime="2021-12-01T03:31:19.000Z" title="发表于 2021-12-01 11:31:19">2021-12-01</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://upload-images.jianshu.io/upload_images/13838098-cdda3865282e1bb4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Jack Ou</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://oujie123.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="true" data-text="I,LOVE,YOU" data-fontsize="15px" data-random="false" async="async"></script></div></body></html>